<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>&</title>
	<meta name="description" content="">
	<meta name="author" content="David Prager Branner">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="http://brannerchinese.github.io/website/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="http://brannerchinese.github.io/website/theme/bootstrap.min.css" rel="stylesheet">
	<link href="http://brannerchinese.github.io/website/theme/local.css" rel="stylesheet">
	<link href="http://brannerchinese.github.io/website/theme/pygments.css" rel="stylesheet">

    <!-- Feeds -->
    <link href="http://brannerchinese.github.io/website/website/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="& Atom Feed" />

</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="http://brannerchinese.github.io/website/">&</a>
			<ul class="nav">
					<li class="active"><a href="http://brannerchinese.github.io/website/category/.html"></a></li>
			</ul>
			<p class="pull-right"><a href="http://brannerchinese.github.io/website/archives.html">[archives]</a> <a href="http://brannerchinese.github.io/website/tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
				<li><a href="https://brannerchinese.com/dpb/publications.html">Publications</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="website/feeds/all.atom.xml">RSS</a></li>
			</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
	<div class='article'>
		<div class="page-header"><h1>Short-circuiting and (and ==) instead of if in Python</h1></div>
		<div class="well small">Permalink: <a class="more" href="http://brannerchinese.github.io/website/short-circuiting-and-instead-of-if-in-python.html">2013-05-01 15:02:00</a>
by <a class="url fn" href="http://brannerchinese.github.io/website/author/david-prager-branner.html">David Prager Branner </a>
 in <a href="http://brannerchinese.github.io/website/category/.html"></a>
</div>
		<div><p>Some people use a special short-circuiting <code>and</code> expression to replace
<code>if</code> blocks in Python. For instance, instead of</p>
<div class="highlight"><pre><span class="k">if</span> <span class="n">x</span> \<span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
    <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>


<p>one can use</p>
<div class="highlight"><pre><span class="n">x</span> \<span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>


<p>The point is that because multi-term logical conditions are evaluated in
series, <code>f(x)</code> is only evaluated after <code>x &gt;= 0.5</code> returns <code>True</code>, making
<code>x &gt;= 0.5</code> a pre-condition of <code>f(x)</code>.</p>
<p>You cannot use an outright assignment (here <code>y = x</code>) as the second part
of the <code>and</code> statement; only a function will do.</p>
<p>In any case, this syntax is unsatisfying to me because it is less
explicit than using <code>if</code> outright. But I've seen it defended by a gifted
programmer as being "explicit once you recognize the syntax", and I
wondered if there was any timing advantage to it.</p>
<p>The results of timing, on 10\^8 iterations, are (in seconds):</p>
<div class="highlight"><pre><span class="n">time</span> <span class="n">using</span> <span class="k">if</span><span class="p">:</span>  <span class="mf">43.7663021088</span>
<span class="n">time</span> <span class="n">using</span> <span class="ow">and</span><span class="p">:</span> <span class="mf">44.545058012</span>
</pre></div>


<p>It doesn't look as though the <code>and</code> statement saves time, particularly.
I suspect it is a case of coding craftiness — surely a pleasurable thing
in itself. But it now seems clear to me that using <code>if</code> is better; it is
both explicit and involves no loss of speed.</p>
<hr />
<p><em>Addendum</em>, later in the evening:</p>
<p>There is another way to use short-circuiting to avoid the use of <code>if</code>:
with <code>==</code> instead of <code>and</code>; for instance:</p>
<div class="highlight"><pre><span class="n">x</span> \<span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="o">==</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>


<p>Just as with <code>and</code>, <code>==</code> causes <code>f(x)</code> to be evaluated after <code>x &gt;= 0.5</code>;
we can show (though I have not done so here) that <code>f(x)</code> is in fact
evaluated. But it turns out that this trick saves even less time:</p>
<div class="highlight"><pre><span class="n">time</span> <span class="n">using</span> <span class="o">==</span><span class="p">:</span>  <span class="mf">50.7892489433</span>
</pre></div>


<p>Best to stick with <code>if</code>, it seems.</p>
<hr />
<p>The program I wrote to compare processing times follows:</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">rounds</span> <span class="o">=</span> <span class="mi">100000000</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">rounds</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">x</span> \<span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">:</span>
            <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;time using if: &#39;</span><span class="p">,</span><span class="err"> </span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">rounds</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="p">()</span>
        <span class="n">x</span> \<span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="ow">and</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;time using and:&#39;</span><span class="p">,</span><span class="err"> </span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">rounds</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="p">()</span>
        <span class="n">x</span> \<span class="o">&gt;=</span> <span class="mf">0.5</span> <span class="o">==</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;time using ==: &#39;</span><span class="p">,</span><span class="err"> </span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
</pre></div>


<p>[end]</p></div>
		<div>
			<h2>Comments</h2>
		<div>
	</div>	
		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; David Prager Branner</p>
		</footer>
	  </div>

	</div>
</body>
</html>