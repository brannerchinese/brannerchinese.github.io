<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>&</title>
	<meta name="description" content="">
	<meta name="author" content="David Prager Branner">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="http://brannerchinese.github.io/website/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="http://brannerchinese.github.io/website/theme/bootstrap.min.css" rel="stylesheet">
	<link href="http://brannerchinese.github.io/website/theme/local.css" rel="stylesheet">
	<link href="http://brannerchinese.github.io/website/theme/pygments.css" rel="stylesheet">

    <!-- Feeds -->
    <link href="http://brannerchinese.github.io/website/website/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="& Atom Feed" />

</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="http://brannerchinese.github.io/website/">&</a>
			<ul class="nav">
					<li class="active"><a href="http://brannerchinese.github.io/website/category/.html"></a></li>
			</ul>
			<p class="pull-right"><a href="http://brannerchinese.github.io/website/archives.html">[archives]</a> <a href="http://brannerchinese.github.io/website/tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
				<li><a href="https://brannerchinese.com/dpb/publications.html">Publications</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="website/feeds/all.atom.xml">RSS</a></li>
			</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
	<div class='article'>
		<div class="page-header"><h1>Useful Python time formats for dealing with HTTP headers</h1></div>
		<div class="well small">Permalink: <a class="more" href="http://brannerchinese.github.io/website/useful-python-time-formats-for-dealing-with-http-headers.html">2012-05-24 13:43:00</a>
by <a class="url fn" href="http://brannerchinese.github.io/website/author/david-prager-branner.html">David Prager Branner </a>
 in <a href="http://brannerchinese.github.io/website/category/.html"></a>
</div>
		<div><h2>Time-formats</h2>
<ol>
<li>
<p><strong>HTTP header format</strong>. HTTP headers use a particular format,
    involving abbreviated English names of the days of the week and the
    months, a comma (after the first of these), day before month before
    year, 24-hour:minute:second, and GMT. Examples:</p>
<div class="highlight"><pre><span class="n">Thu</span><span class="p">,</span> <span class="mo">01</span> <span class="n">Dec</span> <span class="mi">1994</span> <span class="mi">16</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span> <span class="n">GMT</span>

<span class="n">Thu</span><span class="p">,</span> <span class="mi">26</span> <span class="n">Jan</span> <span class="mi">2006</span> <span class="mi">15</span><span class="o">:</span><span class="mo">01</span><span class="o">:</span><span class="mi">16</span> <span class="n">GMT</span>

<span class="n">Tue</span><span class="p">,</span> <span class="mi">12</span> <span class="n">Jan</span> <span class="mi">2010</span> <span class="mi">13</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mo">00</span> <span class="n">GMT</span>
</pre></div>


<p><p>
Note that this is different from what is output by Python's
<code>time.asctime()</code> function.</p>
</li>
<li>
<p><strong>The struct_time object</strong>. Python represents time conveniently as
    a <code>struct_time</code> object, defined at
    [http://docs.python.org/library/time.html#time.struct_time][] as
    "an object with a named tuple interface: values can be accessed by
    index and by attribute name" (accessed 20120523). Here is what the
    first of the three date-time strings above looks like composed as a
    <code>struct_time</code> object:</p>
<div class="highlight"><pre><span class="n">time</span><span class="p">.</span><span class="n">struct_time</span><span class="p">(</span><span class="n">tm_year</span><span class="o">=</span><span class="mi">1994</span><span class="p">,</span> <span class="n">tm_mon</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">tm_mday</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tm_hour</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>

        <span class="n">tm_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tm_sec</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tm_wday</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">tm_yday</span><span class="o">=</span><span class="mi">335</span><span class="p">,</span> <span class="n">tm_isdst</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


</li>
<li>
<p><strong>ISO 8601 standard format</strong>. The International Organization for
    Standardization (ISO) prescribes a standard format for date and
    time: <code>YYYY-MM-DDThh:mm:ss</code>. See [the ISO's informal description of
    the standard][]. (The 2004 revision of the actual specification,
    which costs money to download, is currently available at [this
    site][].)</p>
</li>
<li>
<p><strong>Compact sortable format</strong>. For appending to the names of output
    files when I need to generate multiple versions, and for use as a
    sortable but human-readable date-time string, I use a format
    <code>YYYMMDD_hhmmss</code>. The three dates initially listed above are shown
    in this format here:</p>
<div class="highlight"><pre><span class="mi">19941201</span><span class="n">_160000</span>

<span class="mi">20060126</span><span class="n">_150116</span>

<span class="mi">20100112</span><span class="n">_134800</span>
</pre></div>


<p><p>
I haven't seen this given a standard name in the Python docs, so I
call it "compact sortable" format; it is more compact than the ISO
8601 standard format but still easy to read. In cases where it is
impossible for there to be more than one output file generated in
the same clock minute, I omit the two digits representing seconds.</p>
</li>
</ol>
<h2>Time-format conversions</h2>
<ol>
<li>We can use <code>time.strptime</code> and <code>time.strftime</code> to convert to and
    from a <code>struct_time</code> object using a kind of formatting syntax using
    %, reminiscent of the more primitive of the string-formatting
    syntaxes, and similar to that used in C's <code>sprintf()</code> function.
    Details are provided in the [Python docs cited
    above][http://docs.python.org/library/time.html#time.struct_time].</li>
<li>
<p>Examples:</p>
<ol>
<li>
<p><strong>HTTP header format</strong> and a <code>struct_time</code> object</p>
<ol>
<li>
<p>generate HTTP header format from a <code>struct_time</code> object:</p>
<div class="highlight"><pre><span class="n">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="err">&#39;</span><span class="o">%</span><span class="n">a</span><span class="p">,</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">b</span> <span class="o">%</span><span class="n">Y</span> <span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span> <span class="n">GMT</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">time_struct</span><span class="p">)</span>
</pre></div>


</li>
<li>
<p>generate a <code>struct_time</code> object from HTML header time
    format:</p>
<div class="highlight"><pre><span class="n">time</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">http_header_time</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">%</span><span class="n">a</span><span class="p">,</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">b</span> <span class="o">%</span><span class="n">Y</span> <span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span> <span class="n">GMT</span><span class="err">&#39;</span><span class="p">)</span>
</pre></div>


</li>
<li>
<p>as an identity, deconstruct and regenerate the original HTML
    header time format:</p>
<div class="highlight"><pre><span class="n">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="err">&#39;</span><span class="o">%</span><span class="n">a</span><span class="p">,</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">b</span> <span class="o">%</span><span class="n">Y</span> <span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span> <span class="n">GMT</span><span class="err">&#39;</span><span class="p">,</span>

        <span class="n">time</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">http_header_time</span><span class="p">,</span>

        <span class="err">&#39;</span><span class="o">%</span><span class="n">a</span><span class="p">,</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">b</span> <span class="o">%</span><span class="n">Y</span> <span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span> <span class="n">GMT</span><span class="err">&#39;</span><span class="p">))</span>
</pre></div>


</li>
</ol>
</li>
<li>
<p><strong>ISO 8601 format</strong> and a <code>struct_time</code> object</p>
<ol>
<li>
<p>generate ISO 8601 format from a <code>struct_time</code> object:</p>
<div class="highlight"><pre><span class="n">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="err">&#39;</span><span class="o">%</span><span class="n">Y</span><span class="o">-%</span><span class="n">m</span><span class="o">-%</span><span class="n">dT</span><span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">time_struct</span><span class="p">)</span>
</pre></div>


</li>
<li>
<p>generate a <code>struct_time</code> object from ISO 8601 format:</p>
<div class="highlight"><pre><span class="n">time</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">iso8601</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">%</span><span class="n">Y</span><span class="o">-%</span><span class="n">m</span><span class="o">-%</span><span class="n">dT</span><span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span><span class="err">&#39;</span><span class="p">)</span>
</pre></div>


</li>
<li>
<p>as an identity, deconstruct and regenerate the original ISO
    8601 string:</p>
<div class="highlight"><pre><span class="n">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="err">&#39;</span><span class="o">%</span><span class="n">Y</span><span class="o">-%</span><span class="n">m</span><span class="o">-%</span><span class="n">dT</span><span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">time</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">iso8601</span><span class="p">,</span>

        <span class="err">&#39;</span><span class="o">%</span><span class="n">Y</span><span class="o">-%</span><span class="n">m</span><span class="o">-%</span><span class="n">dT</span><span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span><span class="err">&#39;</span><span class="p">))</span>
</pre></div>


</li>
</ol>
</li>
<li>
<p>produce <strong>compact sortable format</strong> from HTML header time format</p>
<div class="highlight"><pre><span class="n">strftime</span><span class="p">(</span><span class="s">&quot;%Y%m%d_%H%M%S&quot;</span><span class="p">,</span> <span class="n">time</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">http_header_time</span><span class="p">,</span>

        <span class="err">&#39;</span><span class="o">%</span><span class="n">a</span><span class="p">,</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">b</span> <span class="o">%</span><span class="n">Y</span> <span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span> <span class="n">GMT</span><span class="err">&#39;</span><span class="p">))</span>
</pre></div>


</li>
</ol>
</li>
<li>
<p>The following brief functions can be used</p>
<div class="highlight"><pre><span class="n">def</span> <span class="n">make_struct_time</span><span class="p">(</span><span class="n">http_header_time</span><span class="p">)</span><span class="o">:</span>

    <span class="err">&#39;&#39;&#39;</span><span class="n">Input</span> <span class="n">HTML</span> <span class="n">header</span><span class="o">-</span><span class="n">type</span> <span class="n">time</span> <span class="n">string</span> <span class="n">and</span> <span class="n">output</span> <span class="n">struct_time</span><span class="err">&#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">time</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">http_header_time</span><span class="p">,</span>

            <span class="err">&#39;</span><span class="o">%</span><span class="n">a</span><span class="p">,</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">b</span> <span class="o">%</span><span class="n">Y</span> <span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span> <span class="n">GMT</span><span class="err">&#39;</span><span class="p">)</span>

<span class="n">def</span> <span class="n">make_http_time_string</span><span class="p">(</span><span class="n">time_struct</span><span class="p">)</span><span class="o">:</span>

    <span class="err">&#39;&#39;&#39;</span><span class="n">Input</span> <span class="n">struct_time</span> <span class="n">and</span> <span class="n">output</span> <span class="n">HTTP</span> <span class="n">header</span><span class="o">-</span><span class="n">type</span> <span class="n">time</span> <span class="n">string</span><span class="err">&#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="err">&#39;</span><span class="o">%</span><span class="n">a</span><span class="p">,</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">b</span> <span class="o">%</span><span class="n">Y</span> <span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span> <span class="n">GMT</span><span class="err">&#39;</span><span class="p">,</span>

            <span class="n">time_struct</span><span class="p">)</span>

<span class="n">def</span> <span class="n">make_iso8601_time_string</span><span class="p">(</span><span class="n">time_struct</span><span class="p">)</span><span class="o">:</span>

    <span class="err">&#39;&#39;&#39;</span><span class="n">Input</span> <span class="n">struct_time</span> <span class="n">and</span> <span class="n">output</span> <span class="n">an</span> <span class="n">ISO</span> <span class="mi">8601</span> <span class="n">time</span> <span class="n">string</span><span class="err">&#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="err">&#39;</span><span class="o">%</span><span class="n">Y</span><span class="o">-%</span><span class="n">m</span><span class="o">-%</span><span class="n">dT</span><span class="o">%</span><span class="n">H</span><span class="o">:%</span><span class="n">M</span><span class="o">:%</span><span class="n">S</span><span class="err">&#39;</span><span class="p">,</span>

            <span class="n">time_struct</span><span class="p">)</span>

<span class="n">def</span> <span class="n">make_sortable_time_string</span><span class="p">(</span><span class="n">time_struct</span><span class="p">)</span><span class="o">:</span>

    <span class="err">&#39;&#39;&#39;</span><span class="n">Input</span> <span class="n">struct_time</span> <span class="n">and</span> <span class="n">output</span> <span class="n">a</span> <span class="s">&quot;compact sortable&quot;</span> <span class="n">time</span> <span class="n">string</span><span class="err">&#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">time</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="err">&#39;</span><span class="o">%</span><span class="n">Y</span><span class="o">%</span><span class="n">m</span><span class="o">%</span><span class="n">d_</span><span class="o">%</span><span class="n">H</span><span class="o">%</span><span class="n">M</span><span class="o">%</span><span class="n">S</span><span class="err">&#39;</span><span class="p">,</span>

            <span class="n">time_struct</span><span class="p">)</span>
</pre></div>


</li>
</ol>
<h2>Current time</h2>
<ol>
<li>
<p>The following generates our current, local time as a <code>struct_time</code>
    object:</p>
<div class="highlight"><pre><span class="n">time</span><span class="p">.</span><span class="n">localtime</span><span class="p">()</span>
</pre></div>


</li>
</ol>
<p>[end]</p></div>
		<div>
			<h2>Comments</h2>
		<div>
	</div>	
		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; David Prager Branner</p>
		</footer>
	  </div>

	</div>
</body>
</html>