<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>&</title>
	<meta name="description" content="">
	<meta name="author" content="David Prager Branner">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="http://brannerchinese.github.io/website/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="http://brannerchinese.github.io/website/theme/bootstrap.min.css" rel="stylesheet">
	<link href="http://brannerchinese.github.io/website/theme/local.css" rel="stylesheet">
	<link href="http://brannerchinese.github.io/website/theme/pygments.css" rel="stylesheet">

    <!-- Feeds -->
    <link href="http://brannerchinese.github.io/website/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="& Atom Feed" />

</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="http://brannerchinese.github.io/website/">&</a>
			<ul class="nav">
					<li class="active"><a href="http://brannerchinese.github.io/website/category/.html"></a></li>
			</ul>
			<p class="pull-right"><a href="http://brannerchinese.github.io/website/archives.html">[archives]</a> <a href="http://brannerchinese.github.io/website/tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
				<li><a href="https://brannerchinese.com/dpb/publications.html">Publications</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="website/feeds/all.atom.xml">RSS</a></li>
			</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
	<div class='article'>
		<div class="page-header"><h1>Simulating private variables in Python</h1></div>
		<div class="well small">Permalink: <a class="more" href="http://brannerchinese.github.io/website/simulating-private-variables-in-python.html">2011-10-17 18:19:00</a>
by <a class="url fn" href="http://brannerchinese.github.io/website/author/david-prager-branner.html">David Prager Branner </a>
 in <a href="http://brannerchinese.github.io/website/category/.html"></a>
</div>
		<div><p>Python does not have the private member variables that many programming
languages do. I observe three strategies in use to simulate them, none
effective. <em>[Edit:]</em> I don't advocate this; it's not Pythonic. But it's
useful to be able to recognize in code one is reading or contributing
to.</p>
<p>One convention is that a leading single underscore can be use as an
"advisory" or "soft" privacy notation. So a method named <code>method()</code> is
meant to be public, while <code>_method()</code> is supposed to be treated as
private. The leading underscore helps coders to remember not to use it,
although there is no way to keep them from using it if they want to.</p>
<p>A second strategy is the use of such things as private class variables.
These exist mainly not for the sake of privacy but to avoid collisions
between variables with the same name that originate in different
classes. They are marked as private by the use of two distinguishing
characteristics:</p>
<ul>
<li>they are named with a leading "dunder" (double underscore, i.e.,
    <code>__</code>).
    </p>
    <p></li>
<li>"mangling" (alteration) of their names: in order to access them
    outside of their own class, you prefix the dunder with an additional
    single underscore and the name of the class itself.</li>
</ul>
<p></p>
For instance, if you have a class called <code>TheClass</code> containing a method
called <code>__method()</code>, the method can be called on some object <code>thing</code> not
as plain</p>
<p>
> thing.\_\_method()

</p>

<p>but as</p>
<p>
> thing.\_TheClass\_\_method()

</p>

<p>I have posted a little piece of code called <code>degrees_of_privacy.py</code> to
my <a href="https://bitbucket.org/dpb/degrees_of_privacy">BitBucket repository</a> to illustrate the syntax and effects of this
and the "advisory" usages. But even these supposedly private variables
are fully accessible outside of their own classes, as long as they are
correctly named, unlike true private member variables in C++ and other
languages.</p>
<hr />
<p></p>
A third strategy I have observed is that some coders use a single
underscore before the <em>public</em> form of a variable's name and no
underscore before the nominally private form of the same variable. In
2009, <a href="http://code.activestate.com/recipes/576817-red-black-tree">John Reid posted code for a red black tree</a> with a class
definition beginning this way:</p>
<p>
> class rbnode(object):
>
> </p>

<blockquote>
<p>

<blockquote>
<p>def __init__(self, key):</p>
<p></p>
<p></p>
<blockquote>
<p>self._key = key</p>
</blockquote>
</blockquote>
</blockquote>
<p></p>
The point is that (based on a reading of Reid's code) <code>key</code> is
apparently meant to be a private variable and <code>_key</code> a public one.
Similarly, Bruno Preiss, in his [interesting 2003 on-line book of data
structures and algorithms in Python][] uses syntax of the form:</p>
<p>
> class Element(object):
>
> </p>

<blockquote>
<p>

<blockquote>
<p>def __init__(self, list, datum, next):</p>
<p></p>
<p></p>
<blockquote>
<p>self._list = list</p>
<p></p>
self._datum = datum</p>
<p><p>
self._next = next</p>
</blockquote>
</blockquote>
</blockquote>
<p></p>
Again, <code>list</code> seems meant to be private and <code>_list</code> public. There is a
similar prescription in the <a href="http://en.wikipedia.org/wiki/Mutator_method#Python_example">Wikipedia article on mutator methods</a>
(accessed 20111017):</p>
<p>
> class Student():
>
> </p>

<blockquote>
<p>

<blockquote>
<p>def __init__(self, name):</p>
<p></p>
<p></p>
<blockquote>
<p>self._name = name</p>
</blockquote>
</blockquote>
</blockquote>
<p></p>
I wonder where this syntax comes from, since the official Python
documentation and reference books I have consulted do not mention it,
and after all these variables cannot be private in the true sense. Reid
and Preiss enforce their private variables as static (unmodifiable or
read-only) by use of the <code>property()</code> function with the <code>fget</code> function:</p>
<p>
> key = property(fget=lambda self: self.\_key, doc="The node's key")

</p>

<p>(from Reid). Here <code>_key</code> can be changed outside of the class itself, but
<code>key</code> cannot in the absence of <code>fset</code> or <code>fdel</code> as an argument of
<code>property()</code>. That is just the opposite of the "advisory" leading
underscore described near the beginning of this posting.</p>
<p>I can't help thinking that I am looking at indirect influence from C++.
Reid and Preiss are both modeling nodes â€” Reid for a binary tree and
Preiss for a linked list, both structures for which a language with
pointers would be natural. Reid (following the pseudocode in the
algorithms book by Cormen <em>et al</em>.) has some objects of the form</p>
<p>
> z.p.p.right

</p>

<p>meaning the <code>right</code> attribute of an object <code>p</code>, which is itself the
attribute of a different object <code>p</code>, itself the attribute of still
another object <code>z</code>. I can't think of a simpler way than this to model
the nodes of graphs and trees in Python, though it does call to mind a
similar pointer construction</p>
<p>
> ((z-\>p)-\>p)-\>right

</p>

<p>in C++. Perhaps this is an earlier version (or a recollection) of forms
like</p>
<p>
> \_TheClass\_\_method()

</p>

<p>cited above.</p>
<p>[interesting 2003 on-line book of data structures and algorithms in
  Python]: http://www.brpreiss.com/books/opus7/programs/pgm04_11.txt</p></div>
		<div>
			<h2>Comments</h2>
		<div>
	</div>	
		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; David Prager Branner</p>
		</footer>
	  </div>

	</div>
</body>
</html>