<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>&</title>
	<meta name="description" content="">
	<meta name="author" content="David Prager Branner">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="http://brannerchinese.github.io/website/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="http://brannerchinese.github.io/website/theme/bootstrap.min.css" rel="stylesheet">
	<link href="http://brannerchinese.github.io/website/theme/local.css" rel="stylesheet">
	<link href="http://brannerchinese.github.io/website/theme/pygments.css" rel="stylesheet">

    <!-- Feeds -->
    <link href="http://brannerchinese.github.io/website/website/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="& Atom Feed" />

</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="http://brannerchinese.github.io/website/">&</a>
			<ul class="nav">
					<li class="active"><a href="http://brannerchinese.github.io/website/category/.html"></a></li>
			</ul>
			<p class="pull-right"><a href="http://brannerchinese.github.io/website/archives.html">[archives]</a> <a href="http://brannerchinese.github.io/website/tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
				<li><a href="https://brannerchinese.com/dpb/publications.html">Publications</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="website/feeds/all.atom.xml">RSS</a></li>
			</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
	<div class='article'>
		<div class="page-header"><h1>Testing the reliability of the Python priority queue</h1></div>
		<div class="well small">Permalink: <a class="more" href="http://brannerchinese.github.io/website/testing-the-reliability-of-the-python-priority-queue.html">2011-11-20 19:58:00</a>
by <a class="url fn" href="http://brannerchinese.github.io/website/author/david-prager-branner.html">David Prager Branner </a>
 in <a href="http://brannerchinese.github.io/website/category/.html"></a>
</div>
		<div><p>Hearing of a problem with the PriorityQueue class in Python's <code>Queue</code>
module, I wrote <a href="https://bitbucket.org/dpb/queue_test/src">this short program to test the class</a>.</p>
<p>The Python priority queue is modeled here by a list, which is sorted so
as to match the queue's ascending order. The queue data structure
differs from a list in having its size fixed at creation time, making
possible a <code>full()</code> method, which lists do not have. Queues also differ
from lists in that they can be blocked or have a timeout value applied
to their methods, since they are intended for use with threads.
Otherwise, lists have a much larger inventory of functionality.</p>
<p>In the this program, the two objects created are filled with random
numbers, using both <code>put()</code> and <code>get()</code> so that the queue contracts as
well as expands, and then subjected to four tests:</p>
<ol>
<li>The queue should be full (meaning that <code>full()</code> returns True) after
    being created and populated.</li>
<li>The sizes of the objects are compared (using <code>qsize()</code> for the queue
    and <code>len()</code> for the list).</li>
<li>The objects are compared item by item (using <code>get()</code> for the queue
    and indexing for the list).</li>
<li>After all the values in the queue have been dequeued, it should in
    fact be empty, meaning that <code>empty()</code> returns True.</li>
</ol>
<p>This test is repeated in an endless loop which can be terminated with
<code>^C</code>, after which the program reports the number of item-comparisons and
errors found. Failure of either tests 1 or 4, however, will terminate
the loop.</p>
<p>The user is offered the chance to supply the size of the queue and list,
as well as the upper value of the range of random numbers (the lower
value is 1). Default values are 10000 for both variables if the user
does not enter values.</p>
<p>Note that blocking and timeout is not tested here. The <code>put_nowait()</code>
and <code>get_nowait()</code> methods were tested manually but then removed from
the code.</p>
<p><strong>Conclusion</strong>: No problems have been found in <code>Queue.PriorityQueue</code> as of
this writing.</p>
<hr />
<p><strong>Update</strong>, 20111130: I've more recently discussed a more interesting conclusion about this problem: see <a href="lack-of-stable-sort-in-pythons-priority-queue.html">Lack of Stable Sort in Python's Priority Queue</a> and <a href="apparent-error-in-pythons-priority-queue.html">Apparent Error in Python's Priority Queue</a>.</p>
<p>[end]</p></div>
		<div>
			<h2>Comments</h2>
		<div>
	</div>	
		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; David Prager Branner</p>
		</footer>
	  </div>

	</div>
</body>
</html>