<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>&</title>
	<meta name="description" content="">
	<meta name="author" content="David Prager Branner">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="http://brannerchinese.github.io/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="http://brannerchinese.github.io/theme/bootstrap.min.css" rel="stylesheet">
	<link href="http://brannerchinese.github.io/theme/local.css" rel="stylesheet">
	<link href="http://brannerchinese.github.io/theme/pygments.css" rel="stylesheet">

    <!-- Feeds -->
    <link href="http://brannerchinese.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="& Atom Feed" />

</head>
<body>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="http://brannerchinese.github.io/">&</a>
			<ul class="nav">
					<li class="active"><a href="http://brannerchinese.github.io/category/misc.html">misc</a></li>
			</ul>
			<p class="pull-right"><a href="http://brannerchinese.github.io/archives.html">[archives]</a> <a href="http://brannerchinese.github.io/tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
				<li><a href="https://brannerchinese.com/dpb/publications.html">Publications</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="/feeds/all.atom.xml">RSS</a></li>
			</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
	<div class='article'>
		<div class="page-header"><h1>Sorting a list of Unicode strings in Python, case-insensitively and ignoring diacritics</h1></div>
		<div class="well small">Permalink: <a class="more" href="http://brannerchinese.github.io/sorting-a-list-of-unicode-strings-in-python-case-insensitively-and-ignoring-diacritics.html">2012-03-06 00:13:00</a>
by <a class="url fn" href="http://brannerchinese.github.io/author/david-prager-branner.html">David Prager Branner </a>
 in <a href="http://brannerchinese.github.io/category/misc.html">misc</a>
</div>
		<div><p>[<strong>Note, 20130510</strong>: The posting below is correct, but I now maintain
information in my Notes collection — see <a href="https://github.com/brannerchinese/notes/blob/master/CONTENT/Python/Case-insensitive_sort_ignore_diacritics_Python26.md">the current note</a> or visit
<a href="http://htmlpreview.github.io/?https://github.com/brannerchinese/notes/blob/master/searchPage.html">the search page for the Notes collection</a> and search for "sort" or
"insensitive", etc.]</p>
<p>This is tricky, because the sort-key <code>key=str.lower</code> apparently only
works for ASCII strings, not Unicode strings. I get the error</p>
<p><code>TypeError: descriptor 'lower' requires a 'str' object but received a 'unicode'</code></p>
<p>Instead, try declaring your locale and letting your LANG environment set
your encoding for you:</p>
<div class="highlight"><pre><span class="n">import</span> <span class="n">locale</span>

<span class="n">locale</span><span class="p">.</span><span class="n">setlocale</span><span class="p">(</span><span class="n">locale</span><span class="p">.</span><span class="n">LC_ALL</span><span class="p">,</span> <span class="err">&#39;&#39;</span><span class="p">)</span>

<span class="n">listname</span> <span class="o">=</span> <span class="n">sorted</span><span class="p">(</span><span class="n">listname</span><span class="p">,</span> <span class="n">cmp</span><span class="o">=</span><span class="n">locale</span><span class="p">.</span><span class="n">strcoll</span><span class="p">)</span>
</pre></div>


<p>which seems to work. My encoding is set to <code>en_US.UTF-8</code>, which treats
<em>A</em>, <em>a</em>, and <em>ā</em> as the same letter; that's what I want for sorting in
this particular case.</p>
<p>I could also specify the encoding, but according to the Python docs at
[http://docs.python.org/release/2.6.6/library/locale.html?highlight=locale#locale.setlocale][],
it seems the actual encoding can be left out and supplied from one's
environment.</p>
<p>That's what the empty single quotes are; but they need to be there
because <code>setlocale()</code> takes a 2-tuple. Trying that on my system returns
'en_US.UTF-8'. If I omit the single quotes altogether, the function
returns 'C' and the sort is case sensitive.</p>
<div class="highlight"><pre><span class="nl">http:</span><span class="c1">//docs.python.org/release/2.6.6/library/locale.html?highlight=locale#locale.setlocale</span>
</pre></div></div>
		<div>
			<h2>Comments</h2>
		<div>
	</div>	
		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; David Prager Branner</p>
		</footer>
	  </div>

	</div>
</body>
</html>